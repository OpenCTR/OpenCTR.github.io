<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CTRX File Format &mdash; OpenCTR</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="OpenCTR" href="index.html" />
    <link rel="next" title="GNU General Public License" href="GPL.html" />
    <link rel="prev" title="libctr" href="libctr.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner">
        <a href="index.html">
          <img class="logo" src="_static/logo.svg" alt="Logo"/>
        </a>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="libctr.html">libctr</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="GPL.html">GNU General Public License</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="ctrx-file-format">
<h1>CTRX File Format</h1>
<p>The CTRX file format is a relocatable and executable binary format used for Nintendo 3DS Homebrew software. CTRX is itself a superset of the existing <a class="reference external" href="http://3dbrew.org/wiki/3DSX_Format">3DSX</a> format already in use.</p>
<p>Version 1.0 of CTRX is binary-compatible with 3DSX (e.g. CTRX is identical to 3DSX).</p>
</div>
<div class="section" id="creating-ctrx-files">
<h1>Creating CTRX Files</h1>
<p>The CTRXTool is used to convert binary ELF executables into CTRX format. Because CTRXTool is invoked by CMake, through the <code class="docutils literal"><span class="pre">ctr_convert_binary</span></code> function, most ordinary users will not need to invoke CTRXTool directly.</p>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Add link to Tools#ctrxtool when finished.</p>
</div>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">Change ``ctr_convert_binary`` to :macro:`ctr_convert_binary` when CMake doc is finished.</p>
</div>
</div>
<div class="section" id="specification">
<h1>Specification</h1>
<p>The most recent version of CTRX is itself identical to 3DSX. Future versions of CTRX <em>may</em> differ from 3DSX.</p>
<p>Like 3DSX, CTRX is a derivative of the Executable Linkable Format standard. Refer to the offical <a class="reference external" href="http://www.sco.com/developers/gabi/2003-12-17/contents.html">ELF</a> specification and the <a class="reference external" href="http://infocenter.arm.com/help/topic/com.arm.doc.ihi0044e/IHI0044E_aaelf.pdf">ELF for ARM</a> ABI addendum for more information about the ELF standard.</p>
<dl class="docutils">
<dt>CTRX differs from the ELF standard in the following ways:</dt>
<dd><ul class="first last simple">
<li>CTRX is currently not a formally defined standard.</li>
<li>The CTRX format only supports a fixed number of sections.</li>
<li>The CTRX format only defines an executable object.
- Shared object files and relocatable object files are not supported.
- The CTRX executable object itself is relocatable.</li>
<li>It only supports a fixed number of sections.</li>
<li>Only defines relocatable, statically-linked executables. No shared libraries, or modules.</li>
<li>Restricted to 32-Bit ARM platforms.</li>
<li>No debugging support features.</li>
</ul>
</dd>
</dl>
<p>A more explicit specification of the CTRX file format will be provided in the future.</p>
<dl class="docutils">
<dt>The primary data structures of the CTRX format are represented below as tables <a class="footnote-reference" href="#id2" id="id1">[*]</a>:</dt>
<dd><ul class="first last simple">
<li><a class="reference internal" href="#header-table"><span>Header</span></a></li>
<li><a class="reference internal" href="#reloc-header-table"><span>Relocation Header</span></a></li>
<li><a class="reference internal" href="#reloc-table"><span>Relocation Entry</span></a></li>
</ul>
</dd>
</dl>
<table class="docutils footnote" frame="void" id="id2" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[*]</a></td><td>These tables were originally obtained from <a class="reference external" href="http://3dbrew.org/wiki/3DSX_Format">http://3dbrew.org/wiki/3DSX_Format</a></td></tr>
</tbody>
</table>
</div>
<div class="section" id="header">
<span id="header-table"></span><h1>Header</h1>
<table border="1" class="docutils">
<colgroup>
<col width="21%" />
<col width="16%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Offset</th>
<th class="head">Size</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0x00</td>
<td>0x04</td>
<td>Magic (3DSX)</td>
</tr>
<tr class="row-odd"><td>0x04</td>
<td>0x02</td>
<td>Header size</td>
</tr>
<tr class="row-even"><td>0x06</td>
<td>0x02</td>
<td>Relocation Header size</td>
</tr>
<tr class="row-odd"><td>0x08</td>
<td>0x04</td>
<td>Format version</td>
</tr>
<tr class="row-even"><td>0x0C</td>
<td>0x04</td>
<td>Flags</td>
</tr>
<tr class="row-odd"><td>0x10</td>
<td>0x04</td>
<td>Code segment size</td>
</tr>
<tr class="row-even"><td>0x14</td>
<td>0x04</td>
<td>Rodata segment size</td>
</tr>
<tr class="row-odd"><td>0x18</td>
<td>0x04</td>
<td>Data segment size <a class="footnote-reference" href="#id4" id="id3">[†]</a></td>
</tr>
<tr class="row-even"><td>0x1C</td>
<td>0x04</td>
<td>BSS segment size</td>
</tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="id4" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[†]</a></td><td>Data segment size includes the size of the BSS segment.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="relocation-header">
<span id="reloc-header-table"></span><h1>Relocation Header</h1>
<table border="1" class="docutils">
<colgroup>
<col width="17%" />
<col width="13%" />
<col width="70%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Offset</th>
<th class="head">Size</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0x00</td>
<td>0x04</td>
<td>Number of absolute relocations</td>
</tr>
<tr class="row-odd"><td>0x00</td>
<td>0x04</td>
<td>Number of relative relocations</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="relocation">
<span id="reloc-table"></span><h1>Relocation</h1>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="15%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Offset</th>
<th class="head">Size</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>0x00</td>
<td>0x02</td>
<td>Number of words to skip</td>
</tr>
<tr class="row-odd"><td>0x02</td>
<td>0x02</td>
<td>Number of words to patch</td>
</tr>
</tbody>
</table>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="libctr.html">libctr</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="GPL.html">GNU General Public License</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer" role="contentinfo">
    </div>
  </body>
</html>